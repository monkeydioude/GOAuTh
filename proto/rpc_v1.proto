syntax = "proto3";

package v1;

option go_package = "pkg/grpc/v1";

import "google/protobuf/timestamp.proto";

service Auth {
    rpc Signup(UserRequest) returns (Response) {}
    rpc Login(UserRequest) returns (Response) {}
    rpc Delete(AuthIdRequest) returns (Response) {}
}

service JWT {
    rpc Status(Empty) returns (Response) {}
    rpc Refresh(Empty) returns (Response) {}
}

service User {
    rpc Deactivate(Empty) returns (Response) {}
    rpc EditUser(EditUserRequest) returns (Response) {}
}

service UserAction {
    rpc Create(UserActionRequest) returns (Response) {}
    rpc Validate(UserActionValidation) returns (Response) {}
    // rpc Status(UserActionRequest) returns (UserActionStatusResponse) {}
}

message UserRequest {
    string login = 1;
    string password = 2;
    string realm = 3;
}

message Response {
    int32 code = 1;
    string message = 2;
}

// message UserActionStatusResponse {
//     int32 code = 1;
//     string message = 2;
//     repeated UserActionStatus actionStatuses = 3;
// }

message UserActionStatus {
    int32 id = 1;
    string action = 2;
    google.protobuf.Timestamp created_at = 4;
    google.protobuf.Timestamp updated_at = 5;
    google.protobuf.Timestamp validated_at = 6;
}

message EditUserRequest {
    string new_login = 1;
    string new_password = 2;
    string password = 3;
}

message UserActionRequest {
    string login = 1;
    string realm = 2;
    string action = 3;
}

message UserActionValidation{
    string login = 1;
    string realm = 2;
    string data = 3;
    string against = 4;
}

message AuthIdRequest {
    int32 uid = 1;
    string reason = 2;
}

message Empty {}